%% Test LRMC on synthetic data
clear;
addpath PROPACK;
addpath trained_models;

%% Parameters
n = 3000;
n1 = n;
n2 = n;
r = 5;
alpha = 0.2;
p = 0.1;

%% Generate data
[X_star, Y, omega_r, omega_c] = generate_data(n1, n2, r, alpha, p);

%% Run LRMC
model_file = strcat('lrmc_n3000_r5_alpha',num2str(alpha),'_p',num2str(p),'.mat');
load(model_file)

[L,R, errors, times] = LRMC(X_star,Y,r,p,omega_r,omega_c,eta, zeta);


%% Compare with the original matrix
norm(L*R' - X_star, 'fro')/norm(X_star, 'fro')
